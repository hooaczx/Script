local player = game.Players.LocalPlayer
local cam = game.Workspace.CurrentCamera
local tweenservice = game:GetService("TweenService")
local soundid = 1445412859

local rizzsound = Instance.new("Sound", player:WaitForChild("PlayerScripts"))
rizzsound.SoundId = "rbxassetid://" .. soundid
rizzsound.Volume = 1

local skibidiblur = Instance.new("BlurEffect", cam)
skibidiblur.Size = 0

local sigmaeffect = Instance.new("ColorCorrectionEffect", cam)
sigmaeffect.TintColor = Color3.new(1, 1, 1)
sigmaeffect.Saturation = 0

local function createBorder()
    local borderThickness = 0
    local overlayTop = Instance.new("Frame")
    overlayTop.Size = UDim2.new(1, 0, 0, borderThickness)
    overlayTop.Position = UDim2.new(0, 0, 0, 0)
    overlayTop.BackgroundColor3 = Color3.new(1, 0, 0)
    overlayTop.BackgroundTransparency = 0.5
    overlayTop.Visible = false
    overlayTop.Parent = player:WaitForChild("PlayerGui")

    local overlayBottom = overlayTop:Clone()
    overlayBottom.Position = UDim2.new(0, 0, 1, -borderThickness)
    overlayBottom.Parent = player:WaitForChild("PlayerGui")

    local overlayLeft = overlayTop:Clone()
    overlayLeft.Size = UDim2.new(0, borderThickness, 1, 0)
    overlayLeft.Position = UDim2.new(0, 0, 0, 0)
    overlayLeft.Parent = player:WaitForChild("PlayerGui")

    local overlayRight = overlayTop:Clone()
    overlayRight.Position = UDim2.new(1, -borderThickness, 0, 0)
    overlayRight.Size = UDim2.new(0, borderThickness, 1, 0)
    overlayRight.Parent = player:WaitForChild("PlayerGui")

    return overlayTop, overlayBottom, overlayLeft, overlayRight
end

local overlayTop, overlayBottom, overlayLeft, overlayRight = createBorder()

local function applyHitEffect(damage)
    if not effectEnabled then return end

    rizzsound:Play()
    wait(0.1)

    tweenservice:Create(skibidiblur, TweenInfo.new(0.5), {Size = 24}):Play()
    wait(0.5)

    overlayTop.Visible = true
    overlayBottom.Visible = true
    overlayLeft.Visible = true
    overlayRight.Visible = true

    local maxThickness = math.clamp(damage * 5, 10, 100)
    local currentThickness = 0
    overlayTop.Size = UDim2.new(1, 0, 0, currentThickness)
    overlayBottom.Size = UDim2.new(1, 0, 0, currentThickness)
    overlayLeft.Size = UDim2.new(0, currentThickness, 1, 0)
    overlayRight.Size = UDim2.new(0, currentThickness, 1, 0)

    local function fadecolor()
        tweenservice:Create(sigmaeffect, TweenInfo.new(0.5), {TintColor = Color3.new(1, 0, 0), Saturation = -1}):Play()
        wait(0.5)
        tweenservice:Create(sigmaeffect, TweenInfo.new(0.5), {TintColor = Color3.new(1, 1, 1), Saturation = 0}):Play()
        wait(0.5)
    end

    local shakeidk

    local function shakecamera()
        local rs = game:GetService("RunService")

        shakeidk = rs.RenderStepped:Connect(function()
            local ct = tick()
            local bobblex = math.cos(ct * 10) * 1
            local bobbley = math.abs(math.sin(ct * 10)) * 1
            local bobble = Vector3.new(bobblex, bobbley, 0)
            cam.CFrame = cam.CFrame * CFrame.new(bobble)
        end)
    end

    shakecamera()

    while currentThickness < maxThickness do
        currentThickness = currentThickness + 1
        overlayTop.Size = UDim2.new(1, 0, 0, currentThickness)
        overlayBottom.Size = UDim2.new(1, 0, 0, currentThickness)
        overlayLeft.Size = UDim2.new(0, currentThickness, 1, 0)
        overlayRight.Size = UDim2.new(0, currentThickness, 1, 0)

        overlayBottom.Position = UDim2.new(0, 0, 1, -currentThickness)
        overlayRight.Position = UDim2.new(1, -currentThickness, 0, 0)

        wait(0.1)
    end

    if shakeidk then
        shakeidk:Disconnect()
    end

    tweenservice:Create(skibidiblur, TweenInfo.new(0.5), {Size = 0}):Play()
    wait(0.5)

    overlayTop.Visible = false
    overlayBottom.Visible = false
    overlayLeft.Visible = false
    overlayRight.Visible = false
end

local effectEnabled = false

local function connectHealthChanged(humanoid)
    humanoid.HealthChanged:Connect(function(newHealth)
        local damage = humanoid.MaxHealth - newHealth
        if effectEnabled and damage > 0 then
            applyHitEffect(damage)
        end
    end)
end

local function onCharacterAdded(character)
    local humanoid = character:WaitForChild("Humanoid")
    connectHealthChanged(humanoid)
end

if player.Character then
    onCharacterAdded(player.Character)
end

player.CharacterAdded:Connect(onCharacterAdded)

AddToggle(Main5u6, {
    Name = "Enable Hit Effect",
    Default = false,
    Callback = function(value) 
        effectEnabled = value
    end
})
